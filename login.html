<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="favicon.png" type="image/png">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Iniciar sessió</title>

<!-- Import Caveat font from Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet">

<style>
    /* Apply Caveat to all elements */
    * {
        font-family: 'Caveat', cursive;
        font-size: clamp(12px, 4vw, 1.2rem);
    }

    body {
        background-color: #fff;
        display: flex;
        flex-direction: column;
        min-height: 100vh; 
        align-items: center;
        margin: 0;
        padding: 0;
    }

    main {
        flex: 1; 
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center; 
    }

    h2 {
        margin-top: 20px;
        font-size: clamp(20px, 6vw, 2.5rem);
    }

    input {
        display: block;
        margin: 10px 0;
        padding: 10px;
        width:70vw;
        max-width: 250px;
        font-family:Arial, Helvetica, sans-serif;
        font-size:13px;
    }

    button {
        padding: 5px;
        margin: 10px 0;
        cursor: pointer;
        font-size: 20px;
        border: none;
        border-radius: 10px;
    }

    #popup {
        display: none; 
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

    #popupContent {
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        width: 300px;
    }

    #popupContent button {
        margin: 10px;
    }

    p#errorMessage {
        color: red;
    }

    footer {
        background: linear-gradient(90deg, #ff7f50, #ffb347);
        height: 55px;
        width: 100%;
        box-shadow: 0 -8px 8px rgba(0,0,0,0.15);
        border-top: 0px solid rgba(255,255,255,0.3);
        box-sizing: border-box;
        font-size: clamp(10px, 4vw, 1.5rem);
        margin-top:auto;
    }

    a {
        text-decoration: none;
        color: inherit;
    }
     main p {
        margin: 5px 0; /* reduce vertical spacing */
    }

    main p#errorMessage {
        margin: 5px 0 10px 0; /* keep a bit of space above/below error */
    }
</style>
</head>
<body>

  <div id="header"></div>
<script type="module" src="load-header.js"></script>

<main>
<h2>Iniciar sessió</h2>
<input id="email" type="email" placeholder="Adreça email" />
<input id="password" type="password" placeholder="Contrasenya" />
<button id="loginBtn">Inicia sessió</button>

<p id="errorMessage"></p>

<p>
  Encara no tens compte? <a href="signup.html" style="color: rgb(222, 115, 1);">Registra't aquí</a>
</p>

<p><a href="reset-password.html" style="color: rgb(222, 115, 1);">Has oblidat la contrasenya?</a></p>
</main>

<!-- Popup Modal -->
<div id="popup">
    <div id="popupContent">
        <h3>Sessió iniciada!</h3>
        <button id="viewStatsBtn">Veure estadístiques</button>
        <button id="dailyBtn">Anar al rebus diari</button>
    </div>
</div>

<script type="module">
  import { auth } from "./firebase-config.js";
  import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

  const loginBtn = document.getElementById("loginBtn");
  const popup = document.getElementById("popup");
  const viewStatsBtn = document.getElementById("viewStatsBtn");
  const dailyBtn = document.getElementById("dailyBtn");
  const errorMsg = document.getElementById("errorMessage");

  loginBtn.addEventListener("click", () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    errorMsg.textContent = "";

    signInWithEmailAndPassword(auth, email, password)
      .then(() => {
        popup.style.display = "flex";
      })
      .catch(() => {
        errorMsg.textContent = "Usuari o contrasenya incorrectes.";
      });
  });

  viewStatsBtn.addEventListener("click", () => {
    window.location.href = "view-stats.html";
  });

  dailyBtn.addEventListener("click", () => {
    window.location.href = "daily.html";
  });
</script>

<footer>
  <p>&nbsp;&nbsp;© 2025 RebusCAT.</p> 
</footer>
</body>
</html>
